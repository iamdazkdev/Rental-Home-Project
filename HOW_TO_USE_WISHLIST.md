# ğŸ“– HÆ¯á»šNG DáºªN Sá»¬ Dá»¤NG WISHLIST - ADD TO WISHLIST

## ğŸ¯ TÃ­nh NÄƒng Add to Wishlist

TÃ­nh nÄƒng nÃ y cho phÃ©p báº¡n **lÆ°u cÃ¡c listings yÃªu thÃ­ch** Ä‘á»ƒ xem láº¡i sau.

---

## ğŸš€ CÃCH THÃŠM VÃ€O WISHLIST

### BÆ°á»›c 1: Äáº£m Báº£o ÄÃ£ ÄÄƒng Nháº­p âœ…

**Äiá»u kiá»‡n:**
- âœ… Pháº£i Ä‘Äƒng nháº­p vÃ o há»‡ thá»‘ng
- âœ… KhÃ´ng thá»ƒ thÃªm listing cá»§a chÃ­nh mÃ¬nh

**CÃ¡ch kiá»ƒm tra:**
- NhÃ¬n gÃ³c pháº£i trÃªn â†’ tháº¥y avatar cá»§a báº¡n = Ä‘Ã£ Ä‘Äƒng nháº­p
- Náº¿u chÆ°a Ä‘Äƒng nháº­p â†’ Click "Login" vÃ  Ä‘Äƒng nháº­p

### BÆ°á»›c 2: TÃ¬m Listing Báº¡n ThÃ­ch â¤ï¸

**NÆ¡i tÃ¬m listing:**
1. **Trang chá»§ (Home Page)** - Hiá»ƒn thá»‹ táº¥t cáº£ listings
2. **Search** - TÃ¬m kiáº¿m theo Ä‘á»‹a Ä‘iá»ƒm
3. **Categories** - Lá»c theo loáº¡i (Beach, Mountain, v.v.)

### BÆ°á»›c 3: Click Icon TrÃ¡i Tim â¤ï¸

**TrÃªn má»—i listing card, báº¡n sáº½ tháº¥y:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [áº¢nh Listing]          â”‚ â† Slider áº£nh
â”‚                    â¤ï¸    â”‚ â† CLICK VÃ€O ÄÃ‚Y!
â”‚  Beach House            â”‚
â”‚  ÄÃ  Náºµng, Vietnam       â”‚
â”‚  $100/night             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Vá»‹ trÃ­ icon:**
- GÃ³c pháº£i trÃªn cá»§a má»—i listing card
- Icon hÃ¬nh trÃ¡i tim â¤ï¸

**CÃ¡ch click:**
1. Di chuá»™t Ä‘áº¿n icon trÃ¡i tim
2. Click 1 láº§n

### BÆ°á»›c 4: Xem Káº¿t Quáº£ ğŸ‰

**Khi THÃŠM vÃ o wishlist:**
- â¤ï¸ Icon chuyá»ƒn tá»« **TRáº®NG** â†’ **Äá»**
- Console log: "Wishlist updated: Added to wishlist"
- Listing Ä‘Ã£ Ä‘Æ°á»£c lÆ°u!

**Khi XÃ“A khá»i wishlist:**
- â¤ï¸ Icon chuyá»ƒn tá»« **Äá»** â†’ **TRáº®NG**
- Console log: "Wishlist updated: Removed from wishlist"
- Listing Ä‘Ã£ bá»‹ xÃ³a!

---

## ğŸ“‹ XEM DANH SÃCH WISHLIST

### CÃ¡ch 1: Qua Menu
1. Click vÃ o **avatar** (gÃ³c pháº£i trÃªn)
2. Menu dropdown xuáº¥t hiá»‡n
3. Click **"Wish List"**
4. Trang wishlist má»Ÿ ra vá»›i táº¥t cáº£ listings Ä‘Ã£ lÆ°u

### CÃ¡ch 2: Qua URL
```
http://localhost:3000/{userId}/wishlist
```
*(Thay {userId} báº±ng ID cá»§a báº¡n)*

### Trang Wishlist Hiá»ƒn Thá»‹ GÃ¬?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Your Wish List                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Beach   â”‚  â”‚ Mountainâ”‚  â”‚ City    â”‚â”‚
â”‚  â”‚ House   â”‚  â”‚ Villa   â”‚  â”‚ Apt     â”‚â”‚
â”‚  â”‚ â¤ï¸ $100 â”‚  â”‚ â¤ï¸ $150 â”‚  â”‚ â¤ï¸ $80  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**TrÃªn trang Wishlist báº¡n cÃ³ thá»ƒ:**
- âœ… Xem táº¥t cáº£ listings Ä‘Ã£ lÆ°u
- âœ… Click vÃ o listing â†’ xem chi tiáº¿t
- âœ… Click â¤ï¸ Ä‘á»ƒ xÃ³a khá»i wishlist
- âœ… Danh sÃ¡ch tá»± Ä‘á»™ng cáº­p nháº­t

---

## ğŸ’¡ TIPS & TRICKS

### 1. Toggle On/Off
Icon trÃ¡i tim hoáº¡t Ä‘á»™ng nhÆ° **cÃ´ng táº¯c:**
- Click 1 láº§n = ThÃªm (â¤ï¸ Ä‘á»)
- Click láº¡i = XÃ³a (â¤ï¸ tráº¯ng)

### 2. Check Tráº¡ng ThÃ¡i
**CÃ¡ch biáº¿t listing Ä‘Ã£ trong wishlist:**
- Icon trÃ¡i tim mÃ u **Äá»** = ÄÃ£ trong wishlist
- Icon trÃ¡i tim mÃ u **TRáº®NG** = ChÆ°a cÃ³ trong wishlist

### 3. KhÃ´ng Thá»ƒ ThÃªm Listing Cá»§a MÃ¬nh
Náº¿u báº¡n lÃ  chá»§ listing:
- Icon trÃ¡i tim váº«n hiá»ƒn thá»‹
- NhÆ°ng khi click â†’ console log: "Cannot add own listing to wishlist"
- KhÃ´ng cÃ³ thay Ä‘á»•i

### 4. Pháº£i ÄÄƒng Nháº­p
Náº¿u chÆ°a Ä‘Äƒng nháº­p:
- Icon trÃ¡i tim bá»‹ **disabled** (má»)
- KhÃ´ng click Ä‘Æ°á»£c
- Cáº§n login trÆ°á»›c

---

## ğŸ” DEMO FLOW HOÃ€N CHá»ˆNH

### Scenario: LÆ°u má»™t Beach House

**1. ÄÄƒng nháº­p**
```
http://localhost:3000/login
â†’ Enter email & password
â†’ Click "Login"
```

**2. Vá» trang chá»§**
```
http://localhost:3000/
â†’ Tháº¥y danh sÃ¡ch listings
```

**3. TÃ¬m Beach House**
```
Scroll xuá»‘ng
â†’ Tháº¥y card "Beach Front Villa"
â†’ GiÃ¡ $200/night
```

**4. ThÃªm vÃ o Wishlist**
```
Hover lÃªn card
â†’ Tháº¥y icon â¤ï¸ (tráº¯ng) gÃ³c pháº£i trÃªn
â†’ Click vÃ o â¤ï¸
â†’ Icon chuyá»ƒn sang Ä‘á» âœ…
```

**5. Kiá»ƒm tra console**
```
Má»Ÿ DevTools (F12)
â†’ Tab Console
â†’ Tháº¥y: "Wishlist updated: Added to wishlist"
```

**6. VÃ o trang Wishlist**
```
Click avatar (gÃ³c pháº£i trÃªn)
â†’ Click "Wish List"
â†’ Tháº¥y Beach Front Villa trong danh sÃ¡ch âœ…
```

**7. XÃ³a khá»i Wishlist**
```
TrÃªn trang Wishlist
â†’ Click â¤ï¸ trÃªn Beach Front Villa
â†’ Icon chuyá»ƒn sang tráº¯ng
â†’ Card biáº¿n máº¥t khá»i danh sÃ¡ch âœ…
```

---

## ğŸ› TROUBLESHOOTING

### Váº¥n Ä‘á» 1: Icon khÃ´ng Ä‘á»•i mÃ u
**NguyÃªn nhÃ¢n:**
- ChÆ°a Ä‘Äƒng nháº­p
- Server khÃ´ng cháº¡y
- Network error

**Giáº£i phÃ¡p:**
1. Kiá»ƒm tra Ä‘Ã£ login chÆ°a
2. Check server: `lsof -i :5000` (should see node process)
3. Má»Ÿ DevTools â†’ Network tab â†’ xem cÃ³ request failed khÃ´ng
4. Má»Ÿ Console â†’ xem cÃ³ error message khÃ´ng

### Váº¥n Ä‘á» 2: Click vÃ o â¤ï¸ nhÆ°ng khÃ´ng cÃ³ gÃ¬ xáº£y ra
**NguyÃªn nhÃ¢n:**
- Button bá»‹ disabled (chÆ°a login)
- Äang thÃªm listing cá»§a chÃ­nh mÃ¬nh

**Giáº£i phÃ¡p:**
1. Login vÃ o há»‡ thá»‘ng
2. Thá»­ vá»›i listing cá»§a ngÆ°á»i khÃ¡c

### Váº¥n Ä‘á» 3: Trang Wishlist trá»‘ng
**NguyÃªn nhÃ¢n:**
- ChÆ°a thÃªm gÃ¬ vÃ o wishlist
- Wishlist bá»‹ clear

**Giáº£i phÃ¡p:**
1. ThÃªm vÃ i listings vÃ o wishlist trÆ°á»›c
2. Refresh trang
3. Check Redux DevTools â†’ state.user.wishList

### Váº¥n Ä‘á» 4: Icon Ä‘á» nhÆ°ng khÃ´ng tháº¥y trong Wishlist page
**Giáº£i phÃ¡p:**
1. Refresh trang Wishlist
2. Check console cÃ³ errors khÃ´ng
3. Check Network tab xem API calls cÃ³ thÃ nh cÃ´ng khÃ´ng

---

## ğŸ¨ TECHNICAL DETAILS

### API Endpoint
```http
PATCH /user/{userId}/{listingId}
```

**Request:**
- Method: PATCH
- Headers: Content-Type: application/json
- No body needed

**Response Success:**
```json
{
  "message": "Added to wishlist",
  "wishList": ["listingId1", "listingId2", ...]
}
```

**Response Remove:**
```json
{
  "message": "Removed from wishlist",
  "wishList": ["listingId1", ...]
}
```

### Redux State
```javascript
state.user.wishList = [
  "691c477ec358f8a3d6555e6a",
  "691c477ec358f8a3d6555e6b",
  ...
]
```

### Component Code Flow
```javascript
// 1. Check if liked
const isLiked = wishList?.find(item => {
  const itemId = item?._id || item?.id || item;
  return String(itemId) === String(listingId);
});

// 2. On click heart icon
const patchWishList = async () => {
  // Validate user
  if (!user?._id) return;
  if (user._id === creator._id) return;
  
  // Call API
  const response = await fetch(url, {
    method: 'PATCH',
    headers: DEFAULT_HEADERS
  });
  
  // Update Redux
  const data = await response.json();
  dispatch(setWishList(data.wishList));
}

// 3. Render heart icon
<Favorite sx={{color: isLiked ? "red" : "white"}} />
```

---

## âœ… CHECKLIST

TrÆ°á»›c khi sá»­ dá»¥ng, Ä‘áº£m báº£o:

- [ ] Server Ä‘ang cháº¡y (port 5000)
- [ ] Client Ä‘ang cháº¡y (port 3000)
- [ ] ÄÃ£ Ä‘Äƒng nháº­p vÃ o há»‡ thá»‘ng
- [ ] CÃ³ Ã­t nháº¥t 1 listing trong database (khÃ´ng pháº£i cá»§a báº¡n)

Äá»ƒ test:

- [ ] Click â¤ï¸ â†’ icon chuyá»ƒn sang Ä‘á»
- [ ] Click láº¡i â†’ icon chuyá»ƒn vá» tráº¯ng
- [ ] VÃ o Wish List page â†’ tháº¥y listings Ä‘Ã£ lÆ°u
- [ ] Click listing â†’ Ä‘i Ä‘áº¿n detail page
- [ ] XÃ³a tá»« wishlist â†’ card biáº¿n máº¥t

---

## ğŸ“ NEED HELP?

**Documentation:**
- Chi tiáº¿t: `docs/WISHLIST_FEATURE_FIXED_VI.md`
- English: `docs/WISHLIST_FIX.md`

**Verify Setup:**
```bash
./verify-wishlist.sh
```

**Check Logs:**
- Client console (F12)
- Server terminal
- Network tab (DevTools)

---

**Happy Wishlisting! â¤ï¸**

